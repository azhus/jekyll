<!DOCTYPE html>
<html lang="en">
<head>
    <title>
        
        信安武林 | 我走过最长最远的路就是你的套路
        
    </title>
    
    <meta name="description" content="一切通过短信方式诱导用户回复或登录网站输入验证码的短信都是骗砸~"/>
    
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="stylesheet" href="/resources/css/main.css"/>
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
    

    
</head>
<body style="background: url('/resources/images/main_front.jpg') no-repeat fixed;
                            background-size: cover">
<div id="wrapper">
    <header>
    <nav id="main-nav">
        <ul>
            <li><a class="fancy-nav" href="/index.html">home</a></li>
            
            <li><a class="fancy-nav" href="/categories/最新公告">最新公告</a></li>
            
            <li><a class="fancy-nav" href="/categories/传媒信安">传媒信安</a></li>
            
            <li><a class="fancy-nav" href="/categories/课程体系">课程体系</a></li>
            
            <li><a class="fancy-nav" href="/categories/example">example</a></li>
            
            <li><a class="fancy-nav" href="/categories/信息安全科普">信息安全科普</a></li>
            
            <li><a class="fancy-nav" href="/pages/about.html">about</a></li>
        </ul>
    </nav>
</header>

    <main id="start">
        <div class="articles">
            <article>
    <header>
        
        <h1>信安武林 | 我走过最长最远的路就是你的套路</h1>
        
        <div class="post-meta">
    <small>
        <time datetime="22 06 2016">
            22 June, 2016
        </time>
        <span class="tag-sep"> | </span>
        
        <a class="comment_count" href="/%E4%BC%A0%E5%AA%92%E4%BF%A1%E5%AE%89/two-factor-authentication-hack#disqus_thread"
           data-disqus-identifier="/%E4%BC%A0%E5%AA%92%E4%BF%A1%E5%AE%89/two-factor-authentication-hack"></a>
        <span class="tag-sep"> | </span>
        
        <nav class="tags">
    <ul>
        
        <li><a href="/tags/传媒信安.html">传媒信安</a><span>&nbsp;&nbsp;</span></li>
        
    </ul>
</nav>

    </small>
</div>

    </header>
    <p><img src="http://127.0.0.1:4000//resources/images/s1.jpg" alt="" /></p>

<p>现如今的信安武林可不太平，骗子们都是八仙过海，各显神通，懂技术的用技术，技术不行的就看套路。
​
两个月前360天眼实验室就曾经深度还原并分析了因为短信验证码回复的一种补卡攻击导致受害人支付宝、网银盗刷事件的整个套路，萌主先带大家理一理：</p>

<p>1、受害人先莫名其妙收到垃圾杂志短信，当然“见多识广”受害者在没有任何退订提示下回复了“TD”，这时收到指令不正确的短信；</p>

<p>2、接着，”10086“发来一条提醒开通该杂志的业务以及余额不足的短信；</p>

<p>3、紧接着一个陌生的长串号码发来订阅成功的短信，但是”好心“的告诉受害人可以回复”取消+验证码“来退订；</p>

<p>4、而此时，”10086“发来了短信验证码，于是受害者赶紧要退订这个40元/半年的破业务；</p>

<p>5、半个小时后，手机处于了无服务状态，受害者一心以为是订阅了杂志未及时取消而导致欠费停机；</p>

<p>6、再过了半个小时，支付宝发出两条交易提示，一是“5元的游戏币充值”，还有小额的“余额宝转到绑定银行”，之后发生了数笔转账交易；</p>

<p>7、受害者意识到不对后立刻解绑了银行卡，然而悲剧还在进行，所有的网银密码都被篡改了，无服务的手机又不能打客服电话，即使打得了，速度也赶不上交易转账速度；</p>

<p>8、之后，受害者还发现自己的163邮箱被盗、百度钱包绑定了他的三张银行卡。</p>

<p>整个事件中，3的短信其实是通过邮箱服务发送出来的，4的验证码是在线4G换卡的确认验证码，利用受害人可能早已泄露的网银密码，受害人就成了待宰的羔羊。。。</p>

<font color="red">**所以，一切通过短信方式诱导用户回复或登录网站输入验证码的短信都是骗砸~**</font>

<p><img src="http://127.0.0.1:4000//resources/images/s2.jpg" alt="" /> &gt;</p>

<p>于是乎，工信部通信发展司司长闻库表示，上述案例中运营商可能存在潜在漏洞，北京移动已暂停网站自助换卡业务。</p>

<p>目前上海三家运营商均已完全停止在线4G卡补卡和换卡服务，即如果你的4G手机卡遗失或损坏，并想更换，那么只能前往线下营业厅办理。</p>

<p>而对于2G/3G卡更换4G卡的服务，目前上海电信和上海移动均可在线办理，而上海联通用户则必须携带身份证件去线下营业厅办理。</p>

<p><img src="http://127.0.0.1:4000//resources/images/s3.jpg" alt="" /></p>

<p>然而北京上海的盆友们，你们认为这样就安全了，那就图样图森破啊~~~</p>

<p>即使你已经换到了4G卡，短信内容依旧是可以通过网络抓包的。</p>

<p>只能说，套路面前，我们宛如一个智障。。。。。。</p>

<p><img src="http://127.0.0.1:4000//resources/images/s4.jpg" alt="" /></p>

<h3 id="如何防范验证码攻击">如何防范“验证码攻击”?</h3>

<ul>
  <li>静态密码设置一定要复杂。</li>
</ul>

<p>静态密码首先要足够复杂，并妥善保管，防止泄露。</p>

<ul>
  <li>遭遇“干扰信息”，仔细甄别莫慌张。</li>
</ul>

<p>攻击者经常利用各种手段对短信进行伪装，并千方百计地对攻击对象进行误导、甚至恐吓。所以一定要对“运营商”“银行”等身份的手机短信和来电认真甄别。</p>

<ul>
  <li>手机离奇“瘫痪”,紧急“挂失”当先。</li>
</ul>

<p>如果手机瘫痪，要马上查清故障原因。如非手机本身或信号故障，要立刻挂失手机卡，冻结第三方支付和银行账户，避免骗子趁机冒名机主身份窃取账户。</p>

<ul>
  <li>最重要的是——短信验证码不要告诉任何人!</li>
</ul>

<p>运营商和提供相关服务的企业只会将短信验证码下发给用户，绝对不会要求用户通过短信或电话进行所谓“回复验证码”的操作。</p>

<p>当然还有个有效的措施！那就是<font color="red">**双因素认证**</font>，之前本萌主还莫名其妙的被闺蜜夸了~~~</p>

<p><img src="http://127.0.0.1:4000//resources/images/s5.jpg" alt="" /></p>

<p>简单来说，双因素身份认证就是通过你所知道再加上你所能拥有的这二个要素组合到一起才能发挥作用的身份认证系统。</p>

<p>你以为这样就完美的结束了。。。</p>

<p>NO</p>

<p>NO</p>

<p>NO</p>

<p>世事总是难料，黑客现在向世人证明，即使是双因素认证也并非是安全的，他们可以利用<font color="red">**社会工程学**</font>绕过双因素认证。</p>

<p><img src="http://127.0.0.1:4000//resources/images/s6.jpg" alt="" /></p>

<ul>
  <li>攻击者伪装成Google向其用户发送一条虚假短信。此法亦可用于仿冒其他服务提供者向其用户发送短信。</li>
  <li>仿冒发送的短信内容为Google检测到该手机号关联Google账号的可疑行为，需要短信接收者在当前短信会话中回复接收到的来自Google官方发送的短信验证码以避免Google账号被锁定。</li>
  <li>受害者为了避免账号被锁就会回复验证码，并且还傻傻的相信已经击败了企图动他账号的黑客们。</li>
  <li>而此时，黑客已经拿到接管用户账号的所有凭据，利用受害者的凭据和双因素验证码通过上述过程获得该帐户的访问控制权。</li>
</ul>

<font color="red">**重申，一切通过短信方式诱导用户回复或登录网站输入验证码的短信都是骗砸~**</font>

<p>当然，这种攻击方案是黑客伪造短信内容，而非伪造短信发送号码，但是，在中国，伪基站技术普及的环境中，短信来源号码是可以完美伪造的！</p>

<p><img src="http://127.0.0.1:4000//resources/images/s7.jpg" alt="" /></p>

<p>所以，“官方号码”发来的短信本身就可能是套路！</p>

<h3 id="防止电信诈骗你需要知道">防止电信诈骗，你需要知道：</h3>
<ul>
  <li>QQ/微信好友发来的链接不能随便点</li>
  <li>官方号码发来的短信中的链接不能放心点击</li>
  <li>来电号码不确定是否可以回拨之前可以先Google</li>
  <li>陌生号码来电可以准确报出你的姓名并不代表真的认识你</li>
</ul>

<p>不过，运营商当猪队友的蠢事不止一件。。。</p>

<p>说到伪基站，14年中国移动在线免费换 USIM 4G卡，让你告别伪基站的骚扰！</p>

<p>宣传说得响亮，结果打脸也是啪啪啪的。。。。</p>

<p>这就解释了，为撒伪基站的受害者基本都是中国移动的客户，联通少之，电信基本没有。</p>

<blockquote>
  <p>SIM卡的网络认证是单向认证，只要确定卡是活动的，网络就可以发送信息到这个卡上（SO，不管你是真的运营商还是伪基站都可以顺利发送消息到SIM卡）。</p>
</blockquote>

<blockquote>
  <p>USIM卡除了网络对卡的单向认证外，还增加了一个反向认证，就是手机要判断，你这个网络是哪个网络，是不是真网络，如果不是，就不让你给我这个号码发送信息，这样一来，伪基站就不灵光了。</p>
</blockquote>

<p>中国电信的3G CDMA一早就是USIM卡，中国联通在WCDMA时代对新用户发的卡也都是USIM卡。但同期发展国产TD-SCDMA的中国移动，却实行不换号，不换卡用3G的策略，就是因为不换卡，导致了大批移动用户停留在SIM卡阶段，酿成了今天的伪基站之祸。</p>

<p>15年移动又推出了短信保管箱业务，大致的开通流程：</p>

<p>1、凭服务密码或短信随机码可以登录网上营业厅也就是10086网站，然后办理该业务；或者从用户手机发送对应短信办理。</p>

<p>2、用户在对应的网页，可以凭短信随机码来进入自己的短信保管箱，然后里面可以看到自己的收件箱和发件箱。</p>

<p>然后就出现强制被开通该业务，导致短信内容泄露，造成银行卡被盗刷的事件。为了客户信息安全，移动只好先暂停了短信保管箱业务的短信查询功能。</p>

<p>自己的手机、身份证、银行卡还在自己身边，money就不翼而飞了。想想就心塞塞啊！！！</p>

<p><img src="http://127.0.0.1:4000//resources/images/s8.jpg" alt="" /></p>

<p>最后再来点“乐子“吧！</p>

<p>大家可以在app store上搜一下移动营业厅，你会惊奇地发现：</p>

<p><img src="http://127.0.0.1:4000//resources/images/s9.jpg" alt="" /></p>

<p><img src="http://127.0.0.1:4000//resources/images/s10.jpg" alt="" /></p>

<p>万万没想到，原来你是这样的移动营业厅！简直专治各种蛋疼。。。</p>

<p><img src="http://127.0.0.1:4000//resources/images/s11.jpg" alt="" /></p>

<p>数据库都是那一套，但没有统一管理，各自为阵，是存在极大的安全隐患的。如果现在重构，又需要很大的成本，并且也可能不符合移动的业务逻辑，毕竟各地营销推广手段不同。</p>

<font color="red">说了这么多，萌主再次重申，一切通过短信方式诱导用户回复或登录网站输入验证码的短信都是骗砸~</font>

<font color="blue">还是采用TK教主的那句话：我们可能是最后一波曾经有过隐私的人。</font>

<p><img src="http://127.0.0.1:4000//resources/images/s12.jpg" alt="" /></p>

<h3 id="参考文献">参考文献</h3>

<ul>
  <li><a href="http://www.freebuf.com/articles/database/101618.html">趣火星之支付宝、网银盗刷事件：一种补卡攻击的套路全分析</a></li>
  <li><a href="http://securityaffairs.stfi.re/wordpress/48286/cyber-crime/two-factor-authentication-hack.html?sf=ozoojze#aa">How to bypass two-factor authentication with a text message</a></li>
  <li><a href="http://wap.eastmoney.com/ScrollNewsCont.aspx?cd=20160523626405356&amp;vt=0">记者调查:三大运营商全面叫停在线4G补卡,虚商用户换卡要小心</a></li>
  <li><a href="http://post.smzdm.com/p/140532/">体验中国移动在线免费换 USIM 4G卡 — 告别伪基站的垃圾信息</a></li>
  <li><a href="http://www.bjnews.com.cn/feature/2015/07/15/370676.html">移动暂停办理短信保管箱业务</a></li>
  <li><a href="https://www.zhihu.com/question/40468336">为什么中国移动不像联通那种共用一个APP？</a></li>
</ul>

    <footer>
        
        <div id="disqus_thread"></div>
<script>
    /**
     * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    var disqus_developer = 1;
    var disqus_config = function () {
        this.page.url = 'http://localhost:4000/%E4%BC%A0%E5%AA%92%E4%BF%A1%E5%AE%89/two-factor-authentication-hack';
        this.page.identifier = '/%E4%BC%A0%E5%AA%92%E4%BF%A1%E5%AE%89/two-factor-authentication-hack';
        this.page.title = "信安武林 | 我走过最长最远的路就是你的套路";
    };
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = '//.disqus.com/embed.js';

        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
        
    </footer>
</article>

        </div>
    </main>
        <nav class="paginator">
    <ul>
        
        
        <li><a class="fancy-nav" href="/%E4%BC%A0%E5%AA%92%E4%BF%A1%E5%AE%89/BadTunnel">&lt;&nbsp;Previous</a></li>
        
        <li class="sep">&nbsp;</li>
        <li><a class="fancy-nav" href="#">Top</a></li>
        <li class="sep">&nbsp;</li>
        
        <li><a class="fancy-nav" href="/%E4%BC%A0%E5%AA%92%E4%BF%A1%E5%AE%89/zogo">Next&nbsp;&gt;</a></li>
        
        
    </ul>
</nav>

    <footer>
        
<blockquote id="footer-quote">
    <p>
        
        Some fancy quote
        
    </p>
    <footer>
        <cite>
        
        - John Doe
        
    </cite>
    </footer>
</blockquote>

<div id="footer-main">
    <small>
        &copy; 2016 Name Surname. ALL RIGHTS RESERVED.
    </small>
</div>

    </footer>
</div>

</body>
</html>
