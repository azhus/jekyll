---  
layout: post  
title: "全球影响6.5万！FortiGate防火墙被曝存在SSH后门"
date: 2016-01-14
categories:  传媒信安     
comments: true
description: Fortinet公司是继Juniper网络之后又一登上头版头条的企业安全厂商，这次是由于Fortinet公司的防火墙被发现存在一个SSH后门。
tags:
    - 传媒信安
--- 
![](http://127.0.0.1:4000//resources/images/W3.jpg) 


Fortinet公司是继Juniper网络之后又一登上头版头条的企业安全厂商，这次是由于Fortinet公司的防火墙被发现存在一个SSH后门。

就在不足一个月前，一个“未经授权的代码”被发现存在于Juniper旗下的NetScreen防火墙中。公司承认该“未经授权的代码”能够允许攻击者检测并解密VPN流量。

如今，安全专家发现，Fortinet公司的FortiOS防火墙被运用硬编码的SSH登录，这是又一个令人尴尬的揭露。

Fortinet公司在FortiOS-based安全设备上使用了一个秘密的身份认证,但已有未知专家通过逆向工程代码发现了用于访问后门的密码。



![](http://127.0.0.1:4000//resources/images/W4.png) 

 

显然，公司试图低调处理该问题，将此代码定义为“管理身份认证问题”，而非所谓的SSH后门。
> “这个问题已经被解决，并于2014年7月提供了一个补丁来确保我们代码库的质量和完整性。这不是一个‘后门’漏洞问题，而是一个管理的认证问题。”

然而，攻击者能利用此漏洞直接获取FortiOS防火墙的最高管理权限，可以控制设备进行比如抓取流量监听，DNS欺骗，建立隧道进入企业内网等攻击行为。

对此发现，Fortinet非常尴尬并立即删除了FortiOS 防火墙中奇怪的SSH后门。Fortinet试图在一个公告中解释这一令人不安的事件，该公司证实，此问题仅影响到了2012年11月至2014年7月间的FortiOS 4.3.0至4.3.16版本以及5.0.0至5.0.7版本。

> “这个问题由我们的产品安全团队确认，这是他们定期审查和测试工作的一部分。经过认真分析和调查，我们能够验证该问题不能归于各种内部或外部的恶意活动。并且FortiOS 5.0.8及其更高的版本以及FortiOS 4.3.17及其更高的版本都不会受到此问题的影响。”

这意味着，所有在上述时间安装并未再更新的FortiOS-based系统都遭受到了SSH后门的影响。

针对一些由于各种原因无法更新的设备，该公司提出以下方法来暂时解决这个问题：

禁用管理员通过SSH访问的所有接口,并使用Web GUI 来代替。

如果SSH访问是强制性的，通过本地政策—>本地安全策略进行IP地址过滤。

如果你是一个系统管理员，使用FortiOS-based设备升级固件。

**在此，黄老师提醒大家：我们要接受网络单点沦陷的常态化，从近期接连爆出的网络基础设施和网络安全厂商的安全事件来看，攻击者总能在你意想不到的时间通过意想不到的方式获得数据和远程控制权，防御一方不要将自己网络的安全性简单构建在第三方系统和产品的安全可靠上。守方要可以接受局部“失败”，但必须确保全局可控，构建立体化持续对抗的纵深防御体系。**

[阅读原文](http://securityaffairs.co/wordpress/43551/hacking/fortinet-fortios-ssh-backdoor.html#rd?sukey=7f8f3cb2e9b0da451fa819b88c977fc4c32ea307908ebea181931e35c00a22f38a83ffb44468129da3d365b977863737)